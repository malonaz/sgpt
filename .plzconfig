[please]
version = 17.27.0
location = ~/.please

[build]
timeout = 2000
path = /bin:/usr/bin:/usr/local/bin:/opt/homebrew/opt/postgresql@13/bin:/opt/homebrew/bin:/usr/lib/postgresql/13/bin/

[buildconfig]
;; Tracks the core revision.
core-revision = b7ce6a966428b4ffb2970f04103ef3bbe7ba0d7a

[sandbox ]
test = false

[cache]
dir = .plz-cache
dirClean = true
dirCacheHighWaterMark = 5GiB
dirCacheLowWaterMark = 800MiB

[display]
systemstats = true

[parse]
experimentaldir = experimental
preloadsubincludes = ///shell//build_defs:shell
preloadSubincludes = ///python//build_defs:python
preloadsubincludes = ///go//build_defs:go
preloadsubincludes = ///proto//build_defs:proto
preloadsubincludes = ///core//build_defs:remote
preloadsubincludes = ///core//build_defs:docker
preloadsubincludes = ///core//build_defs:k8s
preloadsubincludes = ///core//build_defs:utils
preloadsubincludes = ///core//build_defs/proto:utils
preloadsubincludes = ///core//build_defs:template
preloadsubincludes = ///core//build_defs/proto:go
preloadsubincludes = ///core//build_defs/codegen/go_service:build_defs
preloadsubincludes = ///core//build_defs/codegen/go_proto_templates:build_defs
preloadsubincludes = ///core//build_defs/codegen/postgres:migrator

[Plugin "shell"]
Target = //plugins:shell

[Plugin "python"]
Target = //plugins:python

[Plugin "go"]
Target = //plugins:go
GoTool = //tools/go:toolchain|go
ImportPath = github.com/malonaz/sgpt
CgoEnabled = true

[Plugin "proto"]
Target = //plugins:proto
LanguageDef = ///core//build_defs/proto:go
ProtocFlags = -Ithird_party/proto

[Plugin "core"]
Target = //plugins:core
ProtocGenGoDep = //tools:protoc-gen-go-dep
ProtocGenGrpcGoDep = //tools:protoc-gen-go-grpc-dep

[alias "tidy"]
desc = Tidy pulls third party deps and then calls `lint`
cmd = run ///core//tools/tidy

[alias "lint"]
desc = Tidy generates build targets for dependencies and makes sure that BUILD files are up-to-date
cmd = run ///core//tools/tidy:lint

[alias "bump"]
desc = Bump the core dep.
cmd = run ///core//scripts:bump_core_dep

[alias "postgres"]
desc = Manage a local postgres docker image
cmd = run ///core//scripts:postgres_docker -- --name sgpt --port 8989
subcommand = start
subcommand = stop
subcommand = reset
subcommand = connect
subcommand = connect chat
positionallabels = true

[alias "cli"]
desc = Installs sgpt cli
cmd = run //scripts:install

[alias "deploy"]
desc = Apply ansible deployment playbook
cmd = run //scripts/deploy:deploy

[alias "tail"]
desc = Tail the sgpt-server deployment logs
cmd = run //scripts/deploy:tail
positionallabels = true